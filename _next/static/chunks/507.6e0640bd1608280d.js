"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{4063:function(t){t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(o=n;0!=o--;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(i=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var n,o,i,s=i[o];if(!t(e[s],r[s]))return!1}return!0}return e!=e&&r!=r}},7507:function(t,e,r){r.r(e),r.d(e,{groq:function(){return n},groqStore:function(){return w}});var n=r(114),o=r(4063),i=r(4840),s=["Value","Copy","Blank","ReturnIntoArray","ReturnIntoObject","ReturnIntoObjectSameKey","PushField","PushElement","PushParent","Pop","PushFieldCopy","PushFieldBlank","PushElementCopy","PushElementBlank","ReturnIntoObjectPop","ReturnIntoObjectSameKeyPop","ReturnIntoArrayPop","ObjectSetFieldValue","ObjectCopyField","ObjectDeleteField","ArrayAppendValue","ArrayAppendSlice","StringAppendString","StringAppendSlice"],u=function(){function t(t,e,r){this.i=0,this.inputStack=[],this.outputStack=[],this.model=t,this.root=e,this.patch=r}return t.prototype.read=function(){return this.patch[this.i++]},t.prototype.process=function(){for(this.inputStack.push({value:this.root}),this.outputStack.push({value:this.root});this.i<this.patch.length;){var t=this.read(),e=s[t];if(!e)throw Error("Unknown opcode: "+t);this["process"+e].apply(this)}var r=this.outputStack.pop();return this.finalizeOutput(r)},t.prototype.inputEntry=function(){return this.inputStack[this.inputStack.length-1]},t.prototype.inputKey=function(t,e){return t.keys||(t.keys=this.model.objectGetKeys(t.value).sort()),t.keys[e]},t.prototype.outputEntry=function(){return this.outputStack[this.outputStack.length-1]},t.prototype.outputArray=function(){var t=this.outputEntry();return t.writeValue||(t.writeValue=this.model.copyArray(t.value)),t.writeValue},t.prototype.outputObject=function(){var t=this.outputEntry();return t.writeValue||(t.writeValue=this.model.copyObject(t.value)),t.writeValue},t.prototype.outputString=function(){var t=this.outputEntry();return t.writeValue||(t.writeValue=this.model.copyString(t.value)),t.writeValue},t.prototype.finalizeOutput=function(t){return t.writeValue?this.model.finalize(t.writeValue):t.value},t.prototype.processValue=function(){var t=this.model.wrap(this.read());this.outputStack.push({value:t})},t.prototype.processCopy=function(){var t=this.inputEntry();this.outputStack.push({value:t.value})},t.prototype.processBlank=function(){this.outputStack.push({value:null})},t.prototype.processReturnIntoArray=function(){var t=this.outputStack.pop(),e=this.finalizeOutput(t),r=this.outputArray();this.model.arrayAppendValue(r,e)},t.prototype.processReturnIntoObject=function(){var t=this.read(),e=this.outputStack.pop(),r=this.finalizeOutput(e);r=this.model.markChanged(r);var n=this.outputObject();this.model.objectSetField(n,t,r)},t.prototype.processReturnIntoObjectSameKey=function(){var t=this.inputEntry(),e=this.outputStack.pop(),r=this.finalizeOutput(e),n=this.outputObject();this.model.objectSetField(n,t.key,r)},t.prototype.processPushField=function(){var t=this.read(),e=this.inputEntry(),r=this.inputKey(e,t),n=this.model.objectGetField(e.value,r);this.inputStack.push({value:n,key:r})},t.prototype.processPushElement=function(){var t=this.read(),e=this.inputEntry(),r=this.model.arrayGetElement(e.value,t);this.inputStack.push({value:r})},t.prototype.processPop=function(){this.inputStack.pop()},t.prototype.processPushFieldCopy=function(){this.processPushField(),this.processCopy()},t.prototype.processPushFieldBlank=function(){this.processPushField(),this.processBlank()},t.prototype.processPushElementCopy=function(){this.processPushElement(),this.processCopy()},t.prototype.processPushElementBlank=function(){this.processPushElement(),this.processBlank()},t.prototype.processReturnIntoObjectPop=function(){this.processReturnIntoObject(),this.processPop()},t.prototype.processReturnIntoObjectSameKeyPop=function(){this.processReturnIntoObjectSameKey(),this.processPop()},t.prototype.processReturnIntoArrayPop=function(){this.processReturnIntoArray(),this.processPop()},t.prototype.processObjectSetFieldValue=function(){this.processValue(),this.processReturnIntoObject()},t.prototype.processObjectCopyField=function(){this.processPushField(),this.processCopy(),this.processReturnIntoObjectSameKey(),this.processPop()},t.prototype.processObjectDeleteField=function(){var t=this.read(),e=this.inputEntry(),r=this.inputKey(e,t),n=this.outputObject();this.model.objectDeleteField(n,r)},t.prototype.processArrayAppendValue=function(){var t=this.model.wrap(this.read()),e=this.outputArray();this.model.arrayAppendValue(e,t)},t.prototype.processArrayAppendSlice=function(){var t=this.read(),e=this.read(),r=this.outputArray(),n=this.inputEntry().value;this.model.arrayAppendSlice(r,n,t,e)},t.prototype.processStringAppendString=function(){var t=this.model.wrap(this.read()),e=this.outputString();this.model.stringAppendValue(e,t)},t.prototype.processStringAppendSlice=function(){var t=this.read(),e=this.read(),r=this.outputString(),n=this.inputEntry().value;this.model.stringAppendSlice(r,n,t,e)},t}();function a(t){return t>>16?4:t>>11?3:t>>7?2:1}function c(t,e,r){void 0===r&&(r=0);var n=r,o=0;for(o=r;n<e;o++){var i=t.codePointAt(o),s=a(i);4===s&&o++,n+=s}return o}var p={wrap:function(t){return t},finalize:function(t){return Array.isArray(t)?t:t.data},markChanged:function(t){return t},objectGetKeys:function(t){return Object.keys(t)},objectGetField:function(t,e){return t[e]},arrayGetElement:function(t,e){return t[e]},copyObject:function(t){var e={type:"object",data:{}};if(null!==t)for(var r=0,n=Object.entries(t);r<n.length;r++){var o=n[r],i=o[0],s=o[1];e.data[i]=s}return e},copyArray:function(t){return null===t?[]:t.slice()},copyString:function(t){return{type:"string",data:null===t?"":t}},objectSetField:function(t,e,r){t.data[e]=r},objectDeleteField:function(t,e){delete t.data[e]},arrayAppendValue:function(t,e){t.push(e)},arrayAppendSlice:function(t,e,r,n){t.push.apply(t,e.slice(r,n))},stringAppendSlice:function(t,e,r,n){var o=c(e,r),i=c(e,n,o);t.data+=e.slice(o,i)},stringAppendValue:function(t,e){t.data+=e}};function l(){return(l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}let d=(t,e,r)=>{var n;"undefined"!=typeof window&&t.addEventListener===window.EventSource.prototype.addEventListener&&t.addEventListener(e,r,!1),t.addEventListener(e,r)};function h(t){return t._id.startsWith("drafts.")?t._id.slice(7):t._id}function f(t,e){var r,n;let o=l({},t);return delete o._rev,new u(p,o,e).process()}function y(){return Promise.resolve()}let v,m=t=>t,b=async function({projectId:t,dataset:e,token:r,documentLimit:n}){var o;let i=`https://${t}.api.sanity.io/v1/data/export/${e}`,s=r?{Authorization:`Bearer ${r}`}:void 0,u=await fetch(i,{credentials:"include",headers:s});if(200!==u.status)throw Error(`Error streaming dataset: ${"object"==typeof(o=await u.json())&&"error"in o&&"message"in o?o.message||o.error:"<unknown error>"}`);let a=function(t){if(!t)throw Error("Failed to read body from response");let e,r=!1;function n(){r=!0,e&&e.cancel()}return new ReadableStream({start(o){e=t.getReader();let i=new TextDecoder,s="";e.read().then(async function t(u){if(u.done){if(r)return;return 0===(s=s.trim()).length||o.enqueue(JSON.parse(s)),void o.close()}s+=i.decode(u.value,{stream:!0});let a=s.split("\n");for(let c=0;c<a.length-1;++c){let p=a[c].trim();if(0!==p.length)try{o.enqueue(JSON.parse(p))}catch(l){return o.error(l),void n()}}if(s=a[a.length-1],e)try{t(await e.read())}catch(d){o.error(d)}}).catch(t=>o.error(t))},cancel:n})}(u.body),c=a.getReader(),p=[],l,d;do{if(g(d=(l=await c.read()).value))throw Error(`Error streaming dataset: ${d.error}`);if(d&&!d._id.startsWith("_.")&&p.push(d),n&&p.length>n)throw c.cancel("Reached document limit"),Error(`Error streaming dataset: Reached limit of ${n} documents`)}while(!l.done);return p};function g(t){return!!t&&"error"in t&&"object"==typeof t.error&&null!==t.error&&"description"in t.error&&"string"==typeof t.error.description&&!("_id"in t)}function w(t){var e;!function(){let t=["EventSource","ReadableStream","fetch"].filter(t=>!(t in window));if(t.length>0)throw Error(`Browser not supported. Missing browser APIs: ${t.join(", ")}`)}();let r=null!=(e=t.EventSource)?e:window.EventSource;if(t.token&&r===window.EventSource)throw Error("When`token` option is used, `EventSource` option must also be provided. EventSource cannot be `window.EventSource`, as it does not support passing a token.");return function(t,e){let r=[],s=function(t,e,r){var n,o={},i=o.noTrailing,s=void 0!==i&&i,u=o.noLeading,a=void 0!==u&&u,c=o.debounceMode,p=void 0===c?void 0:c,l=!1,d=0;function h(){n&&clearTimeout(n)}function f(){for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];var u=this,c=Date.now()-d;function f(){d=Date.now(),e.apply(u,o)}function y(){n=void 0}!l&&(a||!p||n||f(),h(),void 0===p&&c>t?a?(d=Date.now(),s||(n=setTimeout(p?y:f,t))):f():!0!==s&&(n=setTimeout(p?y:f,void 0===p?t-c:t)))}return f.cancel=function(t){var e=(t||{}).upcomingOnly;h(),l=!(void 0!==e&&e)},f}(t.subscriptionThrottleMs||50,function(){u.forEach(b)}),u=[],a;async function c(){a||(a=function(t,e,{getDocuments:r,EventSource:n}){let{projectId:o,dataset:i,listen:s,overlayDrafts:u,documentLimit:a,token:c}=t;if(!s)return{unsubscribe:y,loaded:r({projectId:o,dataset:i,documentLimit:a,token:c}).then(k).then(y)};let p=new Map,v,m=[],b,g,w=new Promise((t,e)=>{b=t,g=e}),S,E,j;return{unsubscribe:function(t,e,r){var n;let{projectId:o,dataset:i,token:s}=e,u=new t(`https://${o}.api.sanity.io/v1/data/listen/${i}?query=*&effectFormat=mendoza`,{withCredentials:!0,headers:s?{Authorization:`Bearer ${s}`}:void 0});return d(u,"welcome",r.open),d(u,"mutation",(n=r.next,t=>{let e;try{e=JSON.parse(t.data)}catch(r){return}n(e)})),d(u,"channelError",t=>{let e;u.close();try{e=JSON.parse(t.data)}catch(n){return void r.error(Error("Unknown error parsing listener message"))}r.error(Error(e.message||e.error||`Listener returned HTTP ${e.statusCode}`))}),d(u,"error",t=>{var e;let n="undefined"!=typeof window&&window.location.origin,o=n?`, and that the CORS-origin (${n}) is allowed`:"",i="object"==typeof t&&null!==t&&"message"in t?` (${t.message})`:"";r.error(Error(`Error establishing listener - check that the project ID and dataset are correct${o}${i}`))}),{unsubscribe:()=>Promise.resolve(u.close())}}(n,t,{next:function(t){var e,r;v?(function(t){if(!t.effects||t.documentId.startsWith("_."))return;let e=p.get(t.documentId)||null;!function(t,e){let r=p.get(t),n=v||[],o=r?n.indexOf(r):-1;-1===o&&e?(n.push(e),p.set(t,e)):e?(n.splice(o,1,e),p.set(t,e)):(n.splice(o,1),p.delete(t))}(t.documentId,f(e,t.effects.apply))}(t),e=v,clearTimeout(j),E!==t.transactionId&&S?(k(S),E=void 0):(E=t.transactionId,S=e.slice()),j=setTimeout(k,25,e.slice())):m.push(t)},open:async function(){let t=await r({projectId:o,dataset:i,documentLimit:a,token:c});(v=function(t,e){let r=new Map;return e.forEach(t=>{let e=r.get(t.documentId)||[];e.push(t),r.set(t.documentId,e)}),r.forEach((e,r)=>{let n=t.find(t=>t._id===r);if(!n)return void console.warn("Received mutation for missing document %s",r);let o=!1,i=n;e.forEach(t=>{(o=o||t.previousRev===n._rev)&&t.effects&&(i=f(i,t.effects.apply))}),t.splice(t.indexOf(n),1,i)}),t}(t,m)).forEach(t=>p.set(t._id,t)),k(v),b()},error:t=>g(t)}).unsubscribe,loaded:w};function k(t){S=void 0,j=void 0,E=void 0,e(u?function(t){let e=new Map;return t.forEach(t=>{var r;let n=e.get(h(t));t._id.startsWith("drafts.")?e.set(h(t),l({},t,{_id:h(t)})):n||e.set(t._id,t)}),Array.from(e.values())}(t):t)}}(t,t=>{r=t,s()},e)),await a.loaded}async function p(t,e){await c();let n=(0,i.Q)(t,{params:e});return(await (0,i.k)(n,{dataset:r,params:e})).get()}function b(t){return p(t.query,t.params).then(e=>{"previousResult"in t&&o(t.previousResult,e)||(t.previousResult=e,t.callback(void 0,e))}).catch(e=>{t.callback(e)})}return{query:p,getDocument:async function(t){return await c(),p(n(v||(v=m`*[_id == $id][0]`)),{id:t})},getDocuments:async function(t){return await c(),p(`[${t.map(t=>`*[_id == "${t}"][0]`).join(",\n")}]`)},subscribe:function(e,r,n){if(!t.listen)throw Error("Cannot use `subscribe()` without `listen: true`");let o={query:e,params:r,callback:n};u.push(o);let i=!1;return b(o),{unsubscribe:()=>(i||(i=!0,u.splice(u.indexOf(o),1)),Promise.resolve())}},close:function(){return s.cancel(),a?a.unsubscribe():Promise.resolve()}}}(t,{EventSource:r,getDocuments:b})}}}]);